close all
N = 100;
addpath('fixPSlinestyle')
addpath('data/foam/piecewiselinear_ic/')
pexact02 = load('sam_nx200nt02.mat');
pexact1 = load('sam_nx200nt1.mat');
psam02 = load('sam_nx100nt02.mat');
psam1 = load('sam_nx100nt1.mat');
figure(1)
p = plot(pexact02.x_cent, pexact02.p, psam02.x_cent, psam02.p);
set(gca, 'FontSize',16,'FontWeight','bold');
set(findall(gca, 'Type', 'Line'),'LineWidth',4);
set(p(1),'LineStyle','-','Color','k','Linewidth', 12,...
    'DisplayName','Ref. Sol.');
set(p(2),'MarkerSize',6,'Marker','pentagram','LineWidth',3,...
    'LineStyle','-.',...
    'Color',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'DisplayName','Ref. Sol.');
legend('Ref. Sol.','SAM')
xlabel('x')
ylabel('p')
title('Solution profile as a function of x')
hold on
p = plot(pexact1.x_cent, pexact1.p, psam1.x_cent, psam1.p);
%set(findall(gca, 'Type', 'Line'),'LineWidth',4);
set(gca, 'FontSize',16,'FontWeight','bold');
set(p(1),'LineStyle','-','Color','k','Linewidth', 12,...
    'DisplayName','Ref. Sol.');
set(p(2),'MarkerSize',6,'Marker','pentagram','LineWidth',3,...
    'LineStyle','-.',...
    'Color',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'DisplayName','SAM');
dx = 1 / N;
x1 = 0:dx:1;
p = zeros(size(x1));
p(x1 <= 0.5) = 1 - 2*x1(x1 <= 0.5)';
p = plot(x1,p);
set(p,'LineStyle','-','Color','k','Linewidth',6,...
    'DisplayName','Ref. Sol.');
% set(p,'MarkerSize',6,'Marker','pentagram','LineWidth',3,...
%     'LineStyle','-.',...
%     'Color',[0.47843137383461 0.062745101749897 0.894117653369904],...
%     'DisplayName','SAM');
% Create textbox
annotation('textbox',...
    [0.554539450634153 0.39625850340136 0.104975474738982 0.0799319727891148],...
    'String',{'t = 0.1'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FitBoxToText','off',...
    'LineWidth',2);

% Create textbox
annotation('textbox',...
    [0.425373134328358 0.397959183673469 0.108208955223881 0.0820408163265285],...
    'String',{'t = 0.02'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FitBoxToText','off',...
    'LineWidth',2);

% Create textbox
annotation('textbox',...
    [0.216828358208955 0.409863945578231 0.0994029850746275 0.0790476190476162],...
    'String',{'t = 0.0'},...
    'FontWeight','bold',...
    'FontSize',16,...
    'FitBoxToText','off',...
    'LineWidth',2);
% p = plot(x1, p);

print(1,'-depsc2','test');
fileLoc = '~/Documents/Stanford/Research/ResearchPapers/Discontinous/Results/';
%fixPSlinestyle('test.eps',[fileLoc sprintf('plinearic_possam%i.eps',N)]);
figure(2)
p = plot(pexact1.t-0.0479, pexact1.p_t, psam1.t-0.0479, psam1.p_t);
%add in exact solution for reference
set(findall(gca, 'Type', 'Line'),'LineWidth',4);
set(gca, 'FontSize',16,'FontWeight','bold');
set(p(2),'LineStyle','-',...
    'Color',[0.47843137383461 0.062745101749897 0.894117653369904],...
    'DisplayName','Integral');
set(p(1),'LineStyle','-',...
     'Color','k',...
     'DisplayName','Ref. Sol.');
xlabel('t')
ylabel('p')
%axes1 = axes('FontWeight','bold','FontSize',16);
x_l = 0.005;
x_u = 0.025;
y_l = 0.48;
y_u = 0.56;
h = y_u - y_l;
w = x_u - x_l;
r = rectangle('Position',[x_l y_l w h],'LineWidth',2);
title('Solution profile as a function of t')
print(2,'-depsc2','test');
fixPSlinestyle('test.eps',[fileLoc 'pclinic_sam.eps']);
% Uncomment the following line to preserve the Y-limits of the axes
ylim([0.48 0.56]);
%box('on');
set(findall(gca, 'Type', 'Line'),'LineWidth',6);
legend('Ref. Sol', 'SAM','Location', 'northwest')
xlabel('t')
ylabel('p')
%axes1 = axes('FontWeight','bold','FontSize',16);
title('Solution profile as a function of t')
print(2,'-depsc2','test');
%fixPSlinestyle('test.eps',[fileLoc 'pclinic_samzoom.eps']);